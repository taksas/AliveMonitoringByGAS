# AliveMonitoringByGAS
Googleスプレッドシートと連携したGASを用いた死活監視用スクリプト
 
 下のようなスプレッドシートを作成し、ABC列を埋めます。
![Screenshot_20220324-000526~2](https://user-images.githubusercontent.com/63092685/159731877-a6ec7b67-ee4f-4591-857d-8918f3dc9748.png)

その後、長くて見づらいのでC列は隠してしまいましょう。動作には影響ありません。
![Screenshot_20220324-000502~2](https://user-images.githubusercontent.com/63092685/159732315-b7f802e1-f23f-46aa-aab2-c6f60441f333.png)


このスクリプトには以下の機能があります。
・HTTPステータスコードが200のとき、緑背景に「OK」の文字、それ以外のステータスコードや何も返ってこなかったときは赤背景に「NG」の文字

・ステータスコード、応答時間、死活状態取得時間の表示

・ステータスコードが200以外のとき、ステータスコードを太字＆赤字表示

・応答時間に応じて、5段階の対応。そこまで遅延がないときは応答速度欄の背景が変化。非常に遅延があるときはそれに加えて状態欄が「OK」から「負荷」や「高負荷」になり、状態欄の背景も変化

・C列にURLを入れるだけで監視対象サイトを増やせるスケーラビリティ（GASの無料アカウントの場合、スクリプトは6分間の実行制限があります。この場合、約300件のサイトの監視が可能です）
